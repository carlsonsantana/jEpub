{"version":3,"file":"jepub.js","mappings":"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K,YAAL;AACA,SAAK,WAAL;AACIA,MAAAA,GAAG,GAAGjB,IAAI,CAACsE,KAAL,CAAW,GAAX,EAAgB,CAAhB,CAAN;AACA;;AACJ;AACIrD,MAAAA,GAAG,GAAG,IAAN;AACA;AAjBJ;;AAmBA,SAAOA,GAAP;AACH,EAED;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;AC3Ha;AACb;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,8HAA8H,aAAa;AAC3I;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;;AAEH,kBAAkB,mBAAmB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,sCAAsC,UAAU;AAChD;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,uBAAuB,UAAU;AACjC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,oLAAoL,WAAW;AAC/L;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,6BAA6B,WAAW;AACxC;AACA;AACA;AACA;AACA;;AAEA,sEAAsE,WAAW;AACjF;AACA;AACA;AACA;AACA;;AAEA,6EAA6E,WAAW;AACxF;AACA;AACA;AACA;AACA;;AAEA,8EAA8E,WAAW;AACzF;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,0BAA0B;AAC1B;AACA;;AAEA;AACA;;AAEA;AACA,0CAA0C,OAAO,sBAAsB,OAAO;AAC9E;;AAEA;AACA,8BAA8B,OAAO;AACrC;AACA;AACA;AACA;AACA,MAAM,8BAA8B,OAAO;AAC3C;AACA;AACA;AACA;AACA,MAAM,6BAA6B,OAAO;AAC1C;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,IAAI;;AAEJ;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,4CAA4C,YAAY;AACxD;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,8DAA8D,UAAU;AACxE;AACA,sCAAsC,UAAU;AAChD,sCAAsC,UAAU;AAChD,sCAAsC,UAAU;AAChD,sCAAsC,UAAU;AAChD,sCAAsC,UAAU;AAChD,gCAAgC,UAAU;AAC1C,sCAAsC,UAAU;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,mCAAmC,UAAU;AAC7C,2DAA2D,UAAU;AACrE,mCAAmC,UAAU;AAC7C,mCAAmC,UAAU;AAC7C,mCAAmC,UAAU;AAC7C;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,iCAAiC,UAAU;AAC3C;AACA;AACA;AACA;AACA;;AAEA,uCAAuC,UAAU;AACjD;AACA;AACA;AACA;AACA;;AAEA;AACA,uCAAuC,UAAU;AACjD;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,gHAAgH,OAAO;AACvH;AACA,iHAAiH,oBAAoB;AACrI;AACA;AACA;AACA;AACA;AACA;;AAEA,iHAAiH,oBAAoB;AACrI;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,IAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,kDAAkD,UAAU;AAC5D;AACA;AACA;AACA;AACA;;AAEA;AACA,qBAAqB,wCAAwC;AAC7D;AACA,8BAA8B,cAAc;AAC5C,wBAAwB,kCAAkC;AAC1D;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,wBAAwB,kCAAkC;AAC1D;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,wBAAwB,kCAAkC;AAC1D;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,wBAAwB,kCAAkC;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,qDAAqD,UAAU;AAC/D;AACA,WAAW;AACX;AACA;AACA;AACA;;AAEA;AACA,8DAA8D,WAAW;AACzE;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,yDAAyD,WAAW;AACpE;AACA;AACA;AACA;AACA;;AAEA;AACA,yDAAyD,WAAW;AACpE;AACA;AACA;AACA;AACA;;AAEA;AACA,6CAA6C,WAAW;AACxD;AACA;AACA;AACA;AACA;;AAEA;AACA,yDAAyD,WAAW;AACpE;AACA;AACA;AACA;AACA;;AAEA;AACA,yDAAyD,WAAW;AACpE;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,wCAAwC;AACxC;AACA;AACA;AACA;AACA;;AAEA,wCAAwC;AACxC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,uBAAuB,UAAU;AACjC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,oCAAoC,UAAU;AAC9C,oCAAoC,UAAU;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,oCAAoC,UAAU;AAC9C,oCAAoC,UAAU;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,uBAAuB,WAAW;AAClC;AACA,8BAA8B,UAAU;AACxC,8BAA8B,UAAU;AACxC,8BAA8B,UAAU;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,oBAAoB,UAAU,qBAAqB,YAAY,oBAAoB,YAAY;AAC/F;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,uCAAuC,WAAW;AAClD;AACA;AACA;AACA;AACA;;AAEA,uCAAuC,WAAW;AAClD;AACA;AACA;AACA;AACA;;AAEA,uCAAuC,WAAW;AAClD;AACA;AACA;AACA;AACA;;AAEA,uCAAuC,WAAW;AAClD;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,8DAA8D,WAAW;AACzE;AACA;AACA;AACA;AACA;;AAEA;AACA,sCAAsC,UAAU;AAChD,uCAAuC,UAAU;AACjD;AACA;AACA;AACA;AACA;;AAEA,uCAAuC,UAAU;AACjD;AACA;AACA;AACA;AACA;;AAEA,uCAAuC,UAAU,sCAAsC,UAAU;AACjG;AACA;AACA;AACA;AACA;;AAEA,uCAAuC,UAAU,sCAAsC,UAAU;AACjG;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,sCAAsC,YAAY;AAClD;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,yBAAsB;;AAEtB,iDAAiD,YAAY;;AAE7D,qBAAqB;AACrB;AACA,2CAA2C;;AAE3C;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;;AAEA;;AAEA;AACA,yDAAyD;AACzD,IAAI;AACJ;AACA;AACA,EAAE;AACF,CAAC;;;;;;;;;;;;ACx7BY;AACb,iBAAiB,mBAAO,CAAC,oDAAW;;AAEpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,yBAAsB;;AAEtB,kDAAkD,6BAA6B;;;;;;;;;;;ACjC/E;;;;;;;;;;ACAA,sWAAsW;;;;;;;;;;ACAtW,qWAAqW;;;;;;;;;;ACArW,iWAAiW,oQAAoQ,iDAAiD,iFAAiF,GAAG,qBAAqB,OAAO,qDAAqD;;;;;;;;;;ACA3zB,oWAAoW,oJAAoJ,2PAA2P,GAAG;;;;;;;;;;ACAtvB,qWAAqW,0SAA0S,iGAAiG,mEAAmE,8BAA8B,0FAA0F;;;;;;;;;;ACA36B,wiBAAwiB,8EAA8E,4IAA4I,0EAA0E,6EAA6E,iEAAiE,GAAG,2DAA2D,2HAA2H,gWAAgW,0IAA0I,GAAG,4BAA4B,6IAA6I,uIAAuI,yIAAyI,GAAG,oEAAoE,0EAA0E,iKAAiK,oFAAoF,GAAG,4BAA4B,yEAAyE,qDAAqD,mHAAmH;;;;;;;;;;ACA/sF;;;;;;;;;;ACAA,skCAAskC,qSAAqS,GAAG,4BAA4B,sQAAsQ;;;;;;;;;;;;;;;;;UCAhpD;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;;;UEtBA;UACA;UACA;UACA","sources":["webpack://jEpub/webpack/universalModuleDefinition","webpack://jEpub/./node_modules/@babel/runtime/helpers/interopRequireDefault.js","webpack://jEpub/./node_modules/@babel/runtime/helpers/interopRequireWildcard.js","webpack://jEpub/./node_modules/@babel/runtime/helpers/typeof.js","webpack://jEpub/./src/jepub.js","webpack://jEpub/./src/utils.js","webpack://jEpub/./node_modules/file-type/index.js","webpack://jEpub/./node_modules/image-type/index.js","webpack://jEpub/./src/tpl/epub/META-INF/container.xml","webpack://jEpub/./src/tpl/epub/OEBPS/front-cover.html.ejs","webpack://jEpub/./src/tpl/epub/OEBPS/notes.html.ejs","webpack://jEpub/./src/tpl/epub/OEBPS/page.html.ejs","webpack://jEpub/./src/tpl/epub/OEBPS/table-of-contents.html.ejs","webpack://jEpub/./src/tpl/epub/OEBPS/title-page.html.ejs","webpack://jEpub/./src/tpl/epub/book.opf.ejs","webpack://jEpub/./src/tpl/epub/mimetype","webpack://jEpub/./src/tpl/epub/toc.ncx.ejs","webpack://jEpub/webpack/bootstrap","webpack://jEpub/webpack/before-startup","webpack://jEpub/webpack/startup","webpack://jEpub/webpack/after-startup"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"jEpub\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"jEpub\"] = factory();\n\telse\n\t\troot[\"jEpub\"] = factory();\n})(self, () => {\nreturn ","function _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nmodule.exports = _interopRequireDefault;","var _typeof = require(\"../helpers/typeof\");\n\nfunction _getRequireWildcardCache() {\n  if (typeof WeakMap !== \"function\") return null;\n  var cache = new WeakMap();\n\n  _getRequireWildcardCache = function _getRequireWildcardCache() {\n    return cache;\n  };\n\n  return cache;\n}\n\nfunction _interopRequireWildcard(obj) {\n  if (obj && obj.__esModule) {\n    return obj;\n  }\n\n  if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") {\n    return {\n      \"default\": obj\n    };\n  }\n\n  var cache = _getRequireWildcardCache();\n\n  if (cache && cache.has(obj)) {\n    return cache.get(obj);\n  }\n\n  var newObj = {};\n  var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;\n\n  for (var key in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, key)) {\n      var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;\n\n      if (desc && (desc.get || desc.set)) {\n        Object.defineProperty(newObj, key, desc);\n      } else {\n        newObj[key] = obj[key];\n      }\n    }\n  }\n\n  newObj[\"default\"] = obj;\n\n  if (cache) {\n    cache.set(obj, newObj);\n  }\n\n  return newObj;\n}\n\nmodule.exports = _interopRequireWildcard;","function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    module.exports = _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    module.exports = _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nmodule.exports = _typeof;","'use strict';\n\nimport * as utils from './utils';\nimport imageType from 'image-type';\n\nimport language from './i18n.json';\n\nimport container from './tpl/epub/META-INF/container.xml';\nimport cover from './tpl/epub/OEBPS/front-cover.html';\nimport notes from './tpl/epub/OEBPS/notes.html';\nimport page from './tpl/epub/OEBPS/page.html';\nimport tocInBook from './tpl/epub/OEBPS/table-of-contents.html';\nimport info from './tpl/epub/OEBPS/title-page.html';\nimport bookConfig from './tpl/epub/book.opf';\nimport mime from './tpl/epub/mimetype';\nimport toc from './tpl/epub/toc.ncx';\n\nexport default class jEpub {\n    constructor() {\n        this._I18n = {};\n        this._Info = {};\n        this._Uuid = {};\n        this._Date = null;\n        this._Cover = null;\n\n        this._Pages = [];\n        this._Images = [];\n\n        this._Zip = {};\n    }\n\n    init(details) {\n        if (details instanceof JSZip) {\n            this._Zip = details;\n            return this;\n        }\n\n        this._Info = Object.assign({}, {\n            i18n: 'en',\n            title: 'undefined',\n            author: 'undefined',\n            publisher: 'undefined',\n            description: '',\n            tags: []\n        }, details);\n\n        this._Uuid = {\n            scheme: 'uuid',\n            id: utils.uuidv4()\n        };\n\n        this._Date = utils.getISODate();\n\n        if (!language[this._Info.i18n]) throw `Unknown Language: ${this._Info.i18n}`;\n        this._I18n = language[this._Info.i18n];\n\n        this._Zip = new JSZip();\n        this._Zip.file('mimetype', mime);\n        this._Zip.file('META-INF/container.xml', container);\n        this._Zip.file('OEBPS/title-page.html', ejs.render(info, {\n            i18n: this._I18n,\n            title: this._Info.title,\n            author: this._Info.author,\n            publisher: this._Info.publisher,\n            description: utils.parseDOM(this._Info.description),\n            tags: this._Info.tags,\n        }, {\n            client: true\n        }));\n\n        return this;\n    }\n\n    static html2text(html, noBr = false) {\n        return utils.html2text(html, noBr);\n    }\n\n    date(date) {\n        if (date instanceof Date) {\n            this._Date = utils.getISODate(date);\n            return this;\n        } else {\n            throw 'Date object is not valid';\n        }\n    }\n\n    uuid(id) {\n        if (utils.isEmpty(id)) {\n            throw 'UUID value is empty';\n        } else {\n            let scheme = 'uuid';\n            if (utils.validateUrl(id))\n                scheme = 'URI';\n            this._Uuid = {\n                scheme: scheme,\n                id: id\n            };\n            return this;\n        }\n    }\n\n    cover(data) {\n        let ext, mime;\n        if (data instanceof Blob) {\n            mime = data.type;\n            ext = utils.mime2ext(mime);\n        } else if (data instanceof ArrayBuffer) {\n            ext = imageType(new Uint8Array(data));\n            if (ext) {\n                mime = ext.mime;\n                ext = utils.mime2ext(mime);\n            }\n        } else {\n            throw 'Cover data is not valid';\n        }\n        if (!ext) throw 'Cover data is not allowed';\n\n        this._Cover = {\n            type: mime,\n            path: `OEBPS/cover-image.${ext}`\n        };\n        this._Zip.file(this._Cover.path, data);\n        this._Zip.file('OEBPS/front-cover.html', ejs.render(cover, {\n            i18n: this._I18n,\n            cover: this._Cover\n        }, {\n            client: true\n        }));\n        return this;\n    }\n\n    image(data, name) {\n        let ext, mime;\n        if (data instanceof Blob) {\n            mime = data.type;\n            ext = utils.mime2ext(mime);\n        } else if (data instanceof ArrayBuffer) {\n            ext = imageType(new Uint8Array(data));\n            mime = ext.mime;\n            if (ext) ext = utils.mime2ext(mime);\n        } else {\n            throw 'Image data is not valid';\n        }\n        if (!ext) throw 'Image data is not allowed';\n\n        const filePath = `assets/${name}.${ext}`;\n        this._Images[name] = {\n            type: mime,\n            path: filePath\n        };\n        this._Zip.file(`OEBPS/${filePath}`, data);\n        return this;\n    }\n\n    notes(content) {\n        if (utils.isEmpty(content)) {\n            throw 'Notes is empty';\n        } else {\n            this._Zip.file('OEBPS/notes.html', ejs.render(notes, {\n                i18n: this._I18n,\n                notes: utils.parseDOM(content)\n            }, {\n                client: true\n            }));\n            return this;\n        }\n    }\n\n    add(title, content, index = this._Pages.length) {\n        if (utils.isEmpty(title)) {\n            throw 'Title is empty';\n        } else if (utils.isEmpty(content)) {\n            throw `Content of ${title} is empty`;\n        } else {\n            if (!Array.isArray(content)) {\n                const template = ejs.compile(content, {\n                    client: true\n                });\n                content = template({\n                    image: this._Images\n                }, data => {\n                    return `<img src=\"${(data ? data.path: 'data:image/gif;base64,R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs=')}\" alt=\"\"></img>`;\n                });\n                content = utils.parseDOM(content);\n            }\n            this._Zip.file(`OEBPS/page-${index}.html`, ejs.render(page, {\n                i18n: this._I18n,\n                title: title,\n                content: content\n            }, {\n                client: true\n            }));\n            this._Pages[index] = title;\n            return this;\n        }\n    }\n\n    generate(type = 'blob', onUpdate) {\n        if (!JSZip.support[type]) throw `This browser does not support ${type}`;\n\n        let notes = this._Zip.file('OEBPS/notes.html');\n        notes = !notes ? false : true;\n\n        this._Zip.file('book.opf', ejs.render(bookConfig, {\n            i18n: this._I18n,\n            uuid: this._Uuid,\n            date: this._Date,\n            title: this._Info.title,\n            author: this._Info.author,\n            publisher: this._Info.publisher,\n            description: utils.html2text(this._Info.description, true),\n            tags: this._Info.tags,\n            cover: this._Cover,\n            pages: this._Pages,\n            notes: notes,\n            images: this._Images\n        }, {\n            client: true\n        }));\n\n        this._Zip.file('OEBPS/table-of-contents.html', ejs.render(tocInBook, {\n            i18n: this._I18n,\n            pages: this._Pages\n        }, {\n            client: true\n        }));\n\n        this._Zip.file('toc.ncx', ejs.render(toc, {\n            i18n: this._I18n,\n            uuid: this._Uuid,\n            title: this._Info.title,\n            author: this._Info.author,\n            pages: this._Pages,\n            notes: notes\n        }, {\n            client: true\n        }));\n\n        return this._Zip.generateAsync({\n            type: type,\n            mimeType: mime,\n            compression: 'DEFLATE',\n            compressionOptions: {\n                level: 9\n            }\n        }, onUpdate);\n    }\n}\n","/**\n * Generates a UUID\n * @see https://stackoverflow.com/a/2117523\n * @returns {string} uuid\n */\n\nexport function uuidv4() {\n    return ([1e7] + -1e3 + -4e3 + -8e3 + -1e11).replace(/[018]/g, c =>\n        (c ^ crypto.getRandomValues(new Uint8Array(1))[0] & 15 >> c / 4).toString(16)\n    );\n}\n\n/**\n * Checks if a value is object\n * @see https://stackoverflow.com/a/14706877\n * @returns {boolean}\n */\nexport function isObject(obj) {\n    const type = typeof obj;\n    return type === 'function' || type === 'object' && !!obj;\n}\n\n/**\n * Checks if a value is empty\n * @returns {boolean}\n */\nexport function isEmpty(val) {\n    if (val === null) {\n        return true;\n    } else if (typeof val === 'string') {\n        return !val.trim();\n    }\n    return false;\n}\n\n/**\n * Get current moment in ISO format\n * @param {Object} date\n * @returns {string} ISO date\n */\nexport function getISODate(date = new Date()) {\n    return date.toISOString();\n}\n\n/**\n * Convert convert HTML to valid XHTML\n * @param {String} html\n * @param {String} outText return as plain text\n */\nexport function parseDOM(html, outText = false) {\n    let doc = (new DOMParser).parseFromString(\n        `<!doctype html><body>${html}`,\n        'text/html');\n    if (outText) return doc.body.textContent.trim();\n    doc = (new XMLSerializer).serializeToString(doc.body);\n    doc = doc.replace(/(^<body\\s?[^>]*>|<\\/body>$)/g, '');\n    return doc;\n}\n\n/**\n * Convert HTML to plain text\n * @param {String} html\n */\nexport function html2text(html, noBr = false) {\n    html = html.replace(/<style([\\s\\S]*?)<\\/style>/gi, '');\n    html = html.replace(/<script([\\s\\S]*?)<\\/script>/gi, '');\n    html = html.replace(/<\\/(div|p|li|dd|h[1-6])>/gi, '\\n');\n    html = html.replace(/<(br|hr)\\s*[/]?>/gi, '\\n');\n    html = html.replace(/<li>/ig, '+ ');\n    html = html.replace(/<[^>]+>/g, '');\n    html = html.replace(/\\n{3,}/g, '\\n\\n');\n    html = parseDOM(html, true);\n    if (noBr) html = html.replace(/\\n+/g, ' ');\n    return html;\n}\n\n/**\n * @see https://gist.github.com/dperini/729294\n * @param {String} value\n */\nexport function validateUrl(value) {\n    return /^(?:(?:https?|ftp):\\/\\/)(?:\\S+(?::\\S*)?@)?(?:(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))\\.?)(?::\\d{2,5})?(?:[/?#]\\S*)?$/i.test(value);\n}\n\n/**\n * Convert MIME type to extension\n * @param {String} mime\n */\nexport function mime2ext(mime) {\n    let ext = null;\n    switch (mime) {\n    case 'image/jpg':\n    case 'image/jpeg':\n        ext = 'jpg';\n        break;\n    case 'image/svg+xml':\n        ext = 'svg';\n        break;\n    case 'image/gif':\n    case 'image/apng':\n    case 'image/png':\n    case 'image/webp':\n    case 'image/bmp':\n        ext = mime.split('/')[1];\n        break;\n    default:\n        ext = null;\n        break;\n    }\n    return ext;\n}\n\n// TODO: kepub\n// Wrap text, image <span class=\"koboSpan\" id=\"kobo.{para:số thứ tự đoạn văn, bắt đầu bằng 1}.{seg: số thứ tự cụm bị wrap, bắt đầu bằng 1}\">text</span>\n// https://github.com/pgaskin/kepubify/blob/871aa0bb2047b5ba171bc608024bdb180cb29d70/kepub/transform.go#L173\n\n//UnescapeString\n// var htmlEscaper = strings.NewReplacer(\n// \t`&`, \"&amp;\",\n// \t`'`, \"&#39;\", // \"&#39;\" is shorter than \"&apos;\" and apos was not in HTML until HTML5.\n// \t`<`, \"&lt;\",\n// \t`>`, \"&gt;\",\n// \t`\"`, \"&#34;\", // \"&#34;\" is shorter than \"&quot;\".\n// )\n","'use strict';\nconst toBytes = s => [...s].map(c => c.charCodeAt(0));\nconst xpiZipFilename = toBytes('META-INF/mozilla.rsa');\nconst oxmlContentTypes = toBytes('[Content_Types].xml');\nconst oxmlRels = toBytes('_rels/.rels');\n\nfunction readUInt64LE(buf, offset = 0) {\n\tlet n = buf[offset];\n\tlet mul = 1;\n\tlet i = 0;\n\twhile (++i < 8) {\n\t\tmul *= 0x100;\n\t\tn += buf[offset + i] * mul;\n\t}\n\n\treturn n;\n}\n\nconst fileType = input => {\n\tif (!(input instanceof Uint8Array || input instanceof ArrayBuffer || Buffer.isBuffer(input))) {\n\t\tthrow new TypeError(`Expected the \\`input\\` argument to be of type \\`Uint8Array\\` or \\`Buffer\\` or \\`ArrayBuffer\\`, got \\`${typeof input}\\``);\n\t}\n\n\tconst buf = input instanceof Uint8Array ? input : new Uint8Array(input);\n\n\tif (!(buf && buf.length > 1)) {\n\t\treturn null;\n\t}\n\n\tconst check = (header, options) => {\n\t\toptions = Object.assign({\n\t\t\toffset: 0\n\t\t}, options);\n\n\t\tfor (let i = 0; i < header.length; i++) {\n\t\t\t// If a bitmask is set\n\t\t\tif (options.mask) {\n\t\t\t\t// If header doesn't equal `buf` with bits masked off\n\t\t\t\tif (header[i] !== (options.mask[i] & buf[i + options.offset])) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t} else if (header[i] !== buf[i + options.offset]) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t};\n\n\tconst checkString = (header, options) => check(toBytes(header), options);\n\n\tif (check([0xFF, 0xD8, 0xFF])) {\n\t\treturn {\n\t\t\text: 'jpg',\n\t\t\tmime: 'image/jpeg'\n\t\t};\n\t}\n\n\tif (check([0x89, 0x50, 0x4E, 0x47, 0x0D, 0x0A, 0x1A, 0x0A])) {\n\t\treturn {\n\t\t\text: 'png',\n\t\t\tmime: 'image/png'\n\t\t};\n\t}\n\n\tif (check([0x47, 0x49, 0x46])) {\n\t\treturn {\n\t\t\text: 'gif',\n\t\t\tmime: 'image/gif'\n\t\t};\n\t}\n\n\tif (check([0x57, 0x45, 0x42, 0x50], {offset: 8})) {\n\t\treturn {\n\t\t\text: 'webp',\n\t\t\tmime: 'image/webp'\n\t\t};\n\t}\n\n\tif (check([0x46, 0x4C, 0x49, 0x46])) {\n\t\treturn {\n\t\t\text: 'flif',\n\t\t\tmime: 'image/flif'\n\t\t};\n\t}\n\n\t// Needs to be before `tif` check\n\tif (\n\t\t(check([0x49, 0x49, 0x2A, 0x0]) || check([0x4D, 0x4D, 0x0, 0x2A])) &&\n\t\tcheck([0x43, 0x52], {offset: 8})\n\t) {\n\t\treturn {\n\t\t\text: 'cr2',\n\t\t\tmime: 'image/x-canon-cr2'\n\t\t};\n\t}\n\n\tif (\n\t\tcheck([0x49, 0x49, 0x2A, 0x0]) ||\n\t\tcheck([0x4D, 0x4D, 0x0, 0x2A])\n\t) {\n\t\treturn {\n\t\t\text: 'tif',\n\t\t\tmime: 'image/tiff'\n\t\t};\n\t}\n\n\tif (check([0x42, 0x4D])) {\n\t\treturn {\n\t\t\text: 'bmp',\n\t\t\tmime: 'image/bmp'\n\t\t};\n\t}\n\n\tif (check([0x49, 0x49, 0xBC])) {\n\t\treturn {\n\t\t\text: 'jxr',\n\t\t\tmime: 'image/vnd.ms-photo'\n\t\t};\n\t}\n\n\tif (check([0x38, 0x42, 0x50, 0x53])) {\n\t\treturn {\n\t\t\text: 'psd',\n\t\t\tmime: 'image/vnd.adobe.photoshop'\n\t\t};\n\t}\n\n\t// Zip-based file formats\n\t// Need to be before the `zip` check\n\tif (check([0x50, 0x4B, 0x3, 0x4])) {\n\t\tif (\n\t\t\tcheck([0x6D, 0x69, 0x6D, 0x65, 0x74, 0x79, 0x70, 0x65, 0x61, 0x70, 0x70, 0x6C, 0x69, 0x63, 0x61, 0x74, 0x69, 0x6F, 0x6E, 0x2F, 0x65, 0x70, 0x75, 0x62, 0x2B, 0x7A, 0x69, 0x70], {offset: 30})\n\t\t) {\n\t\t\treturn {\n\t\t\t\text: 'epub',\n\t\t\t\tmime: 'application/epub+zip'\n\t\t\t};\n\t\t}\n\n\t\t// Assumes signed `.xpi` from addons.mozilla.org\n\t\tif (check(xpiZipFilename, {offset: 30})) {\n\t\t\treturn {\n\t\t\t\text: 'xpi',\n\t\t\t\tmime: 'application/x-xpinstall'\n\t\t\t};\n\t\t}\n\n\t\tif (checkString('mimetypeapplication/vnd.oasis.opendocument.text', {offset: 30})) {\n\t\t\treturn {\n\t\t\t\text: 'odt',\n\t\t\t\tmime: 'application/vnd.oasis.opendocument.text'\n\t\t\t};\n\t\t}\n\n\t\tif (checkString('mimetypeapplication/vnd.oasis.opendocument.spreadsheet', {offset: 30})) {\n\t\t\treturn {\n\t\t\t\text: 'ods',\n\t\t\t\tmime: 'application/vnd.oasis.opendocument.spreadsheet'\n\t\t\t};\n\t\t}\n\n\t\tif (checkString('mimetypeapplication/vnd.oasis.opendocument.presentation', {offset: 30})) {\n\t\t\treturn {\n\t\t\t\text: 'odp',\n\t\t\t\tmime: 'application/vnd.oasis.opendocument.presentation'\n\t\t\t};\n\t\t}\n\n\t\t// The docx, xlsx and pptx file types extend the Office Open XML file format:\n\t\t// https://en.wikipedia.org/wiki/Office_Open_XML_file_formats\n\t\t// We look for:\n\t\t// - one entry named '[Content_Types].xml' or '_rels/.rels',\n\t\t// - one entry indicating specific type of file.\n\t\t// MS Office, OpenOffice and LibreOffice may put the parts in different order, so the check should not rely on it.\n\t\tconst findNextZipHeaderIndex = (arr, startAt = 0) => arr.findIndex((el, i, arr) => i >= startAt && arr[i] === 0x50 && arr[i + 1] === 0x4B && arr[i + 2] === 0x3 && arr[i + 3] === 0x4);\n\n\t\tlet zipHeaderIndex = 0; // The first zip header was already found at index 0\n\t\tlet oxmlFound = false;\n\t\tlet type = null;\n\n\t\tdo {\n\t\t\tconst offset = zipHeaderIndex + 30;\n\n\t\t\tif (!oxmlFound) {\n\t\t\t\toxmlFound = (check(oxmlContentTypes, {offset}) || check(oxmlRels, {offset}));\n\t\t\t}\n\n\t\t\tif (!type) {\n\t\t\t\tif (checkString('word/', {offset})) {\n\t\t\t\t\ttype = {\n\t\t\t\t\t\text: 'docx',\n\t\t\t\t\t\tmime: 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'\n\t\t\t\t\t};\n\t\t\t\t} else if (checkString('ppt/', {offset})) {\n\t\t\t\t\ttype = {\n\t\t\t\t\t\text: 'pptx',\n\t\t\t\t\t\tmime: 'application/vnd.openxmlformats-officedocument.presentationml.presentation'\n\t\t\t\t\t};\n\t\t\t\t} else if (checkString('xl/', {offset})) {\n\t\t\t\t\ttype = {\n\t\t\t\t\t\text: 'xlsx',\n\t\t\t\t\t\tmime: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (oxmlFound && type) {\n\t\t\t\treturn type;\n\t\t\t}\n\n\t\t\tzipHeaderIndex = findNextZipHeaderIndex(buf, offset);\n\t\t} while (zipHeaderIndex >= 0);\n\n\t\t// No more zip parts available in the buffer, but maybe we are almost certain about the type?\n\t\tif (type) {\n\t\t\treturn type;\n\t\t}\n\t}\n\n\tif (\n\t\tcheck([0x50, 0x4B]) &&\n\t\t(buf[2] === 0x3 || buf[2] === 0x5 || buf[2] === 0x7) &&\n\t\t(buf[3] === 0x4 || buf[3] === 0x6 || buf[3] === 0x8)\n\t) {\n\t\treturn {\n\t\t\text: 'zip',\n\t\t\tmime: 'application/zip'\n\t\t};\n\t}\n\n\tif (check([0x75, 0x73, 0x74, 0x61, 0x72], {offset: 257})) {\n\t\treturn {\n\t\t\text: 'tar',\n\t\t\tmime: 'application/x-tar'\n\t\t};\n\t}\n\n\tif (\n\t\tcheck([0x52, 0x61, 0x72, 0x21, 0x1A, 0x7]) &&\n\t\t(buf[6] === 0x0 || buf[6] === 0x1)\n\t) {\n\t\treturn {\n\t\t\text: 'rar',\n\t\t\tmime: 'application/x-rar-compressed'\n\t\t};\n\t}\n\n\tif (check([0x1F, 0x8B, 0x8])) {\n\t\treturn {\n\t\t\text: 'gz',\n\t\t\tmime: 'application/gzip'\n\t\t};\n\t}\n\n\tif (check([0x42, 0x5A, 0x68])) {\n\t\treturn {\n\t\t\text: 'bz2',\n\t\t\tmime: 'application/x-bzip2'\n\t\t};\n\t}\n\n\tif (check([0x37, 0x7A, 0xBC, 0xAF, 0x27, 0x1C])) {\n\t\treturn {\n\t\t\text: '7z',\n\t\t\tmime: 'application/x-7z-compressed'\n\t\t};\n\t}\n\n\tif (check([0x78, 0x01])) {\n\t\treturn {\n\t\t\text: 'dmg',\n\t\t\tmime: 'application/x-apple-diskimage'\n\t\t};\n\t}\n\n\tif (check([0x33, 0x67, 0x70, 0x35]) || // 3gp5\n\t\t(\n\t\t\tcheck([0x0, 0x0, 0x0]) && check([0x66, 0x74, 0x79, 0x70], {offset: 4}) &&\n\t\t\t\t(\n\t\t\t\t\tcheck([0x6D, 0x70, 0x34, 0x31], {offset: 8}) || // MP41\n\t\t\t\t\tcheck([0x6D, 0x70, 0x34, 0x32], {offset: 8}) || // MP42\n\t\t\t\t\tcheck([0x69, 0x73, 0x6F, 0x6D], {offset: 8}) || // ISOM\n\t\t\t\t\tcheck([0x69, 0x73, 0x6F, 0x32], {offset: 8}) || // ISO2\n\t\t\t\t\tcheck([0x6D, 0x6D, 0x70, 0x34], {offset: 8}) || // MMP4\n\t\t\t\t\tcheck([0x4D, 0x34, 0x56], {offset: 8}) || // M4V\n\t\t\t\t\tcheck([0x64, 0x61, 0x73, 0x68], {offset: 8}) // DASH\n\t\t\t\t)\n\t\t)) {\n\t\treturn {\n\t\t\text: 'mp4',\n\t\t\tmime: 'video/mp4'\n\t\t};\n\t}\n\n\tif (check([0x4D, 0x54, 0x68, 0x64])) {\n\t\treturn {\n\t\t\text: 'mid',\n\t\t\tmime: 'audio/midi'\n\t\t};\n\t}\n\n\t// https://github.com/threatstack/libmagic/blob/master/magic/Magdir/matroska\n\tif (check([0x1A, 0x45, 0xDF, 0xA3])) {\n\t\tconst sliced = buf.subarray(4, 4 + 4096);\n\t\tconst idPos = sliced.findIndex((el, i, arr) => arr[i] === 0x42 && arr[i + 1] === 0x82);\n\n\t\tif (idPos !== -1) {\n\t\t\tconst docTypePos = idPos + 3;\n\t\t\tconst findDocType = type => [...type].every((c, i) => sliced[docTypePos + i] === c.charCodeAt(0));\n\n\t\t\tif (findDocType('matroska')) {\n\t\t\t\treturn {\n\t\t\t\t\text: 'mkv',\n\t\t\t\t\tmime: 'video/x-matroska'\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tif (findDocType('webm')) {\n\t\t\t\treturn {\n\t\t\t\t\text: 'webm',\n\t\t\t\t\tmime: 'video/webm'\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t}\n\n\tif (check([0x0, 0x0, 0x0, 0x14, 0x66, 0x74, 0x79, 0x70, 0x71, 0x74, 0x20, 0x20]) ||\n\t\tcheck([0x66, 0x72, 0x65, 0x65], {offset: 4}) || // Type: `free`\n\t\tcheck([0x66, 0x74, 0x79, 0x70, 0x71, 0x74, 0x20, 0x20], {offset: 4}) ||\n\t\tcheck([0x6D, 0x64, 0x61, 0x74], {offset: 4}) || // MJPEG\n\t\tcheck([0x6D, 0x6F, 0x6F, 0x76], {offset: 4}) || // Type: `moov`\n\t\tcheck([0x77, 0x69, 0x64, 0x65], {offset: 4})) {\n\t\treturn {\n\t\t\text: 'mov',\n\t\t\tmime: 'video/quicktime'\n\t\t};\n\t}\n\n\t// RIFF file format which might be AVI, WAV, QCP, etc\n\tif (check([0x52, 0x49, 0x46, 0x46])) {\n\t\tif (check([0x41, 0x56, 0x49], {offset: 8})) {\n\t\t\treturn {\n\t\t\t\text: 'avi',\n\t\t\t\tmime: 'video/vnd.avi'\n\t\t\t};\n\t\t}\n\n\t\tif (check([0x57, 0x41, 0x56, 0x45], {offset: 8})) {\n\t\t\treturn {\n\t\t\t\text: 'wav',\n\t\t\t\tmime: 'audio/vnd.wave'\n\t\t\t};\n\t\t}\n\n\t\t// QLCM, QCP file\n\t\tif (check([0x51, 0x4C, 0x43, 0x4D], {offset: 8})) {\n\t\t\treturn {\n\t\t\t\text: 'qcp',\n\t\t\t\tmime: 'audio/qcelp'\n\t\t\t};\n\t\t}\n\t}\n\n\t// ASF_Header_Object first 80 bytes\n\tif (check([0x30, 0x26, 0xB2, 0x75, 0x8E, 0x66, 0xCF, 0x11, 0xA6, 0xD9])) {\n\t\t// Search for header should be in first 1KB of file.\n\n\t\tlet offset = 30;\n\t\tdo {\n\t\t\tconst objectSize = readUInt64LE(buf, offset + 16);\n\t\t\tif (check([0x91, 0x07, 0xDC, 0xB7, 0xB7, 0xA9, 0xCF, 0x11, 0x8E, 0xE6, 0x00, 0xC0, 0x0C, 0x20, 0x53, 0x65], {offset})) {\n\t\t\t\t// Sync on Stream-Properties-Object (B7DC0791-A9B7-11CF-8EE6-00C00C205365)\n\t\t\t\tif (check([0x40, 0x9E, 0x69, 0xF8, 0x4D, 0x5B, 0xCF, 0x11, 0xA8, 0xFD, 0x00, 0x80, 0x5F, 0x5C, 0x44, 0x2B], {offset: offset + 24})) {\n\t\t\t\t\t// Found audio:\n\t\t\t\t\treturn {\n\t\t\t\t\t\text: 'wma',\n\t\t\t\t\t\tmime: 'audio/x-ms-wma'\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tif (check([0xC0, 0xEF, 0x19, 0xBC, 0x4D, 0x5B, 0xCF, 0x11, 0xA8, 0xFD, 0x00, 0x80, 0x5F, 0x5C, 0x44, 0x2B], {offset: offset + 24})) {\n\t\t\t\t\t// Found video:\n\t\t\t\t\treturn {\n\t\t\t\t\t\text: 'wmv',\n\t\t\t\t\t\tmime: 'video/x-ms-asf'\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\toffset += objectSize;\n\t\t} while (offset + 24 <= buf.length);\n\n\t\t// Default to ASF generic extension\n\t\treturn {\n\t\t\text: 'asf',\n\t\t\tmime: 'application/vnd.ms-asf'\n\t\t};\n\t}\n\n\tif (\n\t\tcheck([0x0, 0x0, 0x1, 0xBA]) ||\n\t\tcheck([0x0, 0x0, 0x1, 0xB3])\n\t) {\n\t\treturn {\n\t\t\text: 'mpg',\n\t\t\tmime: 'video/mpeg'\n\t\t};\n\t}\n\n\tif (check([0x66, 0x74, 0x79, 0x70, 0x33, 0x67], {offset: 4})) {\n\t\treturn {\n\t\t\text: '3gp',\n\t\t\tmime: 'video/3gpp'\n\t\t};\n\t}\n\n\t// Check for MPEG header at different starting offsets\n\tfor (let start = 0; start < 2 && start < (buf.length - 16); start++) {\n\t\tif (\n\t\t\tcheck([0x49, 0x44, 0x33], {offset: start}) || // ID3 header\n\t\t\tcheck([0xFF, 0xE2], {offset: start, mask: [0xFF, 0xE2]}) // MPEG 1 or 2 Layer 3 header\n\t\t) {\n\t\t\treturn {\n\t\t\t\text: 'mp3',\n\t\t\t\tmime: 'audio/mpeg'\n\t\t\t};\n\t\t}\n\n\t\tif (\n\t\t\tcheck([0xFF, 0xE4], {offset: start, mask: [0xFF, 0xE4]}) // MPEG 1 or 2 Layer 2 header\n\t\t) {\n\t\t\treturn {\n\t\t\t\text: 'mp2',\n\t\t\t\tmime: 'audio/mpeg'\n\t\t\t};\n\t\t}\n\n\t\tif (\n\t\t\tcheck([0xFF, 0xF8], {offset: start, mask: [0xFF, 0xFC]}) // MPEG 2 layer 0 using ADTS\n\t\t) {\n\t\t\treturn {\n\t\t\t\text: 'mp2',\n\t\t\t\tmime: 'audio/mpeg'\n\t\t\t};\n\t\t}\n\n\t\tif (\n\t\t\tcheck([0xFF, 0xF0], {offset: start, mask: [0xFF, 0xFC]}) // MPEG 4 layer 0 using ADTS\n\t\t) {\n\t\t\treturn {\n\t\t\t\text: 'mp4',\n\t\t\t\tmime: 'audio/mpeg'\n\t\t\t};\n\t\t}\n\t}\n\n\tif (\n\t\tcheck([0x66, 0x74, 0x79, 0x70, 0x4D, 0x34, 0x41], {offset: 4})\n\t) {\n\t\treturn { // MPEG-4 layer 3 (audio)\n\t\t\text: 'm4a',\n\t\t\tmime: 'audio/mp4' // RFC 4337\n\t\t};\n\t}\n\n\t// Needs to be before `ogg` check\n\tif (check([0x4F, 0x70, 0x75, 0x73, 0x48, 0x65, 0x61, 0x64], {offset: 28})) {\n\t\treturn {\n\t\t\text: 'opus',\n\t\t\tmime: 'audio/opus'\n\t\t};\n\t}\n\n\t// If 'OggS' in first  bytes, then OGG container\n\tif (check([0x4F, 0x67, 0x67, 0x53])) {\n\t\t// This is a OGG container\n\n\t\t// If ' theora' in header.\n\t\tif (check([0x80, 0x74, 0x68, 0x65, 0x6F, 0x72, 0x61], {offset: 28})) {\n\t\t\treturn {\n\t\t\t\text: 'ogv',\n\t\t\t\tmime: 'video/ogg'\n\t\t\t};\n\t\t}\n\n\t\t// If '\\x01video' in header.\n\t\tif (check([0x01, 0x76, 0x69, 0x64, 0x65, 0x6F, 0x00], {offset: 28})) {\n\t\t\treturn {\n\t\t\t\text: 'ogm',\n\t\t\t\tmime: 'video/ogg'\n\t\t\t};\n\t\t}\n\n\t\t// If ' FLAC' in header  https://xiph.org/flac/faq.html\n\t\tif (check([0x7F, 0x46, 0x4C, 0x41, 0x43], {offset: 28})) {\n\t\t\treturn {\n\t\t\t\text: 'oga',\n\t\t\t\tmime: 'audio/ogg'\n\t\t\t};\n\t\t}\n\n\t\t// 'Speex  ' in header https://en.wikipedia.org/wiki/Speex\n\t\tif (check([0x53, 0x70, 0x65, 0x65, 0x78, 0x20, 0x20], {offset: 28})) {\n\t\t\treturn {\n\t\t\t\text: 'spx',\n\t\t\t\tmime: 'audio/ogg'\n\t\t\t};\n\t\t}\n\n\t\t// If '\\x01vorbis' in header\n\t\tif (check([0x01, 0x76, 0x6F, 0x72, 0x62, 0x69, 0x73], {offset: 28})) {\n\t\t\treturn {\n\t\t\t\text: 'ogg',\n\t\t\t\tmime: 'audio/ogg'\n\t\t\t};\n\t\t}\n\n\t\t// Default OGG container https://www.iana.org/assignments/media-types/application/ogg\n\t\treturn {\n\t\t\text: 'ogx',\n\t\t\tmime: 'application/ogg'\n\t\t};\n\t}\n\n\tif (check([0x66, 0x4C, 0x61, 0x43])) {\n\t\treturn {\n\t\t\text: 'flac',\n\t\t\tmime: 'audio/x-flac'\n\t\t};\n\t}\n\n\tif (check([0x4D, 0x41, 0x43, 0x20])) { // 'MAC '\n\t\treturn {\n\t\t\text: 'ape',\n\t\t\tmime: 'audio/ape'\n\t\t};\n\t}\n\n\tif (check([0x77, 0x76, 0x70, 0x6B])) { // 'wvpk'\n\t\treturn {\n\t\t\text: 'wv',\n\t\t\tmime: 'audio/wavpack'\n\t\t};\n\t}\n\n\tif (check([0x23, 0x21, 0x41, 0x4D, 0x52, 0x0A])) {\n\t\treturn {\n\t\t\text: 'amr',\n\t\t\tmime: 'audio/amr'\n\t\t};\n\t}\n\n\tif (check([0x25, 0x50, 0x44, 0x46])) {\n\t\treturn {\n\t\t\text: 'pdf',\n\t\t\tmime: 'application/pdf'\n\t\t};\n\t}\n\n\tif (check([0x4D, 0x5A])) {\n\t\treturn {\n\t\t\text: 'exe',\n\t\t\tmime: 'application/x-msdownload'\n\t\t};\n\t}\n\n\tif (\n\t\t(buf[0] === 0x43 || buf[0] === 0x46) &&\n\t\tcheck([0x57, 0x53], {offset: 1})\n\t) {\n\t\treturn {\n\t\t\text: 'swf',\n\t\t\tmime: 'application/x-shockwave-flash'\n\t\t};\n\t}\n\n\tif (check([0x7B, 0x5C, 0x72, 0x74, 0x66])) {\n\t\treturn {\n\t\t\text: 'rtf',\n\t\t\tmime: 'application/rtf'\n\t\t};\n\t}\n\n\tif (check([0x00, 0x61, 0x73, 0x6D])) {\n\t\treturn {\n\t\t\text: 'wasm',\n\t\t\tmime: 'application/wasm'\n\t\t};\n\t}\n\n\tif (\n\t\tcheck([0x77, 0x4F, 0x46, 0x46]) &&\n\t\t(\n\t\t\tcheck([0x00, 0x01, 0x00, 0x00], {offset: 4}) ||\n\t\t\tcheck([0x4F, 0x54, 0x54, 0x4F], {offset: 4})\n\t\t)\n\t) {\n\t\treturn {\n\t\t\text: 'woff',\n\t\t\tmime: 'font/woff'\n\t\t};\n\t}\n\n\tif (\n\t\tcheck([0x77, 0x4F, 0x46, 0x32]) &&\n\t\t(\n\t\t\tcheck([0x00, 0x01, 0x00, 0x00], {offset: 4}) ||\n\t\t\tcheck([0x4F, 0x54, 0x54, 0x4F], {offset: 4})\n\t\t)\n\t) {\n\t\treturn {\n\t\t\text: 'woff2',\n\t\t\tmime: 'font/woff2'\n\t\t};\n\t}\n\n\tif (\n\t\tcheck([0x4C, 0x50], {offset: 34}) &&\n\t\t(\n\t\t\tcheck([0x00, 0x00, 0x01], {offset: 8}) ||\n\t\t\tcheck([0x01, 0x00, 0x02], {offset: 8}) ||\n\t\t\tcheck([0x02, 0x00, 0x02], {offset: 8})\n\t\t)\n\t) {\n\t\treturn {\n\t\t\text: 'eot',\n\t\t\tmime: 'application/vnd.ms-fontobject'\n\t\t};\n\t}\n\n\tif (check([0x00, 0x01, 0x00, 0x00, 0x00])) {\n\t\treturn {\n\t\t\text: 'ttf',\n\t\t\tmime: 'font/ttf'\n\t\t};\n\t}\n\n\tif (check([0x4F, 0x54, 0x54, 0x4F, 0x00])) {\n\t\treturn {\n\t\t\text: 'otf',\n\t\t\tmime: 'font/otf'\n\t\t};\n\t}\n\n\tif (check([0x00, 0x00, 0x01, 0x00])) {\n\t\treturn {\n\t\t\text: 'ico',\n\t\t\tmime: 'image/x-icon'\n\t\t};\n\t}\n\n\tif (check([0x00, 0x00, 0x02, 0x00])) {\n\t\treturn {\n\t\t\text: 'cur',\n\t\t\tmime: 'image/x-icon'\n\t\t};\n\t}\n\n\tif (check([0x46, 0x4C, 0x56, 0x01])) {\n\t\treturn {\n\t\t\text: 'flv',\n\t\t\tmime: 'video/x-flv'\n\t\t};\n\t}\n\n\tif (check([0x25, 0x21])) {\n\t\treturn {\n\t\t\text: 'ps',\n\t\t\tmime: 'application/postscript'\n\t\t};\n\t}\n\n\tif (check([0xFD, 0x37, 0x7A, 0x58, 0x5A, 0x00])) {\n\t\treturn {\n\t\t\text: 'xz',\n\t\t\tmime: 'application/x-xz'\n\t\t};\n\t}\n\n\tif (check([0x53, 0x51, 0x4C, 0x69])) {\n\t\treturn {\n\t\t\text: 'sqlite',\n\t\t\tmime: 'application/x-sqlite3'\n\t\t};\n\t}\n\n\tif (check([0x4E, 0x45, 0x53, 0x1A])) {\n\t\treturn {\n\t\t\text: 'nes',\n\t\t\tmime: 'application/x-nintendo-nes-rom'\n\t\t};\n\t}\n\n\tif (check([0x43, 0x72, 0x32, 0x34])) {\n\t\treturn {\n\t\t\text: 'crx',\n\t\t\tmime: 'application/x-google-chrome-extension'\n\t\t};\n\t}\n\n\tif (\n\t\tcheck([0x4D, 0x53, 0x43, 0x46]) ||\n\t\tcheck([0x49, 0x53, 0x63, 0x28])\n\t) {\n\t\treturn {\n\t\t\text: 'cab',\n\t\t\tmime: 'application/vnd.ms-cab-compressed'\n\t\t};\n\t}\n\n\t// Needs to be before `ar` check\n\tif (check([0x21, 0x3C, 0x61, 0x72, 0x63, 0x68, 0x3E, 0x0A, 0x64, 0x65, 0x62, 0x69, 0x61, 0x6E, 0x2D, 0x62, 0x69, 0x6E, 0x61, 0x72, 0x79])) {\n\t\treturn {\n\t\t\text: 'deb',\n\t\t\tmime: 'application/x-deb'\n\t\t};\n\t}\n\n\tif (check([0x21, 0x3C, 0x61, 0x72, 0x63, 0x68, 0x3E])) {\n\t\treturn {\n\t\t\text: 'ar',\n\t\t\tmime: 'application/x-unix-archive'\n\t\t};\n\t}\n\n\tif (check([0xED, 0xAB, 0xEE, 0xDB])) {\n\t\treturn {\n\t\t\text: 'rpm',\n\t\t\tmime: 'application/x-rpm'\n\t\t};\n\t}\n\n\tif (\n\t\tcheck([0x1F, 0xA0]) ||\n\t\tcheck([0x1F, 0x9D])\n\t) {\n\t\treturn {\n\t\t\text: 'Z',\n\t\t\tmime: 'application/x-compress'\n\t\t};\n\t}\n\n\tif (check([0x4C, 0x5A, 0x49, 0x50])) {\n\t\treturn {\n\t\t\text: 'lz',\n\t\t\tmime: 'application/x-lzip'\n\t\t};\n\t}\n\n\tif (check([0xD0, 0xCF, 0x11, 0xE0, 0xA1, 0xB1, 0x1A, 0xE1])) {\n\t\treturn {\n\t\t\text: 'msi',\n\t\t\tmime: 'application/x-msi'\n\t\t};\n\t}\n\n\tif (check([0x06, 0x0E, 0x2B, 0x34, 0x02, 0x05, 0x01, 0x01, 0x0D, 0x01, 0x02, 0x01, 0x01, 0x02])) {\n\t\treturn {\n\t\t\text: 'mxf',\n\t\t\tmime: 'application/mxf'\n\t\t};\n\t}\n\n\tif (check([0x47], {offset: 4}) && (check([0x47], {offset: 192}) || check([0x47], {offset: 196}))) {\n\t\treturn {\n\t\t\text: 'mts',\n\t\t\tmime: 'video/mp2t'\n\t\t};\n\t}\n\n\tif (check([0x42, 0x4C, 0x45, 0x4E, 0x44, 0x45, 0x52])) {\n\t\treturn {\n\t\t\text: 'blend',\n\t\t\tmime: 'application/x-blender'\n\t\t};\n\t}\n\n\tif (check([0x42, 0x50, 0x47, 0xFB])) {\n\t\treturn {\n\t\t\text: 'bpg',\n\t\t\tmime: 'image/bpg'\n\t\t};\n\t}\n\n\tif (check([0x00, 0x00, 0x00, 0x0C, 0x6A, 0x50, 0x20, 0x20, 0x0D, 0x0A, 0x87, 0x0A])) {\n\t\t// JPEG-2000 family\n\n\t\tif (check([0x6A, 0x70, 0x32, 0x20], {offset: 20})) {\n\t\t\treturn {\n\t\t\t\text: 'jp2',\n\t\t\t\tmime: 'image/jp2'\n\t\t\t};\n\t\t}\n\n\t\tif (check([0x6A, 0x70, 0x78, 0x20], {offset: 20})) {\n\t\t\treturn {\n\t\t\t\text: 'jpx',\n\t\t\t\tmime: 'image/jpx'\n\t\t\t};\n\t\t}\n\n\t\tif (check([0x6A, 0x70, 0x6D, 0x20], {offset: 20})) {\n\t\t\treturn {\n\t\t\t\text: 'jpm',\n\t\t\t\tmime: 'image/jpm'\n\t\t\t};\n\t\t}\n\n\t\tif (check([0x6D, 0x6A, 0x70, 0x32], {offset: 20})) {\n\t\t\treturn {\n\t\t\t\text: 'mj2',\n\t\t\t\tmime: 'image/mj2'\n\t\t\t};\n\t\t}\n\t}\n\n\tif (check([0x46, 0x4F, 0x52, 0x4D])) {\n\t\treturn {\n\t\t\text: 'aif',\n\t\t\tmime: 'audio/aiff'\n\t\t};\n\t}\n\n\tif (checkString('<?xml ')) {\n\t\treturn {\n\t\t\text: 'xml',\n\t\t\tmime: 'application/xml'\n\t\t};\n\t}\n\n\tif (check([0x42, 0x4F, 0x4F, 0x4B, 0x4D, 0x4F, 0x42, 0x49], {offset: 60})) {\n\t\treturn {\n\t\t\text: 'mobi',\n\t\t\tmime: 'application/x-mobipocket-ebook'\n\t\t};\n\t}\n\n\t// File Type Box (https://en.wikipedia.org/wiki/ISO_base_media_file_format)\n\tif (check([0x66, 0x74, 0x79, 0x70], {offset: 4})) {\n\t\tif (check([0x6D, 0x69, 0x66, 0x31], {offset: 8})) {\n\t\t\treturn {\n\t\t\t\text: 'heic',\n\t\t\t\tmime: 'image/heif'\n\t\t\t};\n\t\t}\n\n\t\tif (check([0x6D, 0x73, 0x66, 0x31], {offset: 8})) {\n\t\t\treturn {\n\t\t\t\text: 'heic',\n\t\t\t\tmime: 'image/heif-sequence'\n\t\t\t};\n\t\t}\n\n\t\tif (check([0x68, 0x65, 0x69, 0x63], {offset: 8}) || check([0x68, 0x65, 0x69, 0x78], {offset: 8})) {\n\t\t\treturn {\n\t\t\t\text: 'heic',\n\t\t\t\tmime: 'image/heic'\n\t\t\t};\n\t\t}\n\n\t\tif (check([0x68, 0x65, 0x76, 0x63], {offset: 8}) || check([0x68, 0x65, 0x76, 0x78], {offset: 8})) {\n\t\t\treturn {\n\t\t\t\text: 'heic',\n\t\t\t\tmime: 'image/heic-sequence'\n\t\t\t};\n\t\t}\n\t}\n\n\tif (check([0xAB, 0x4B, 0x54, 0x58, 0x20, 0x31, 0x31, 0xBB, 0x0D, 0x0A, 0x1A, 0x0A])) {\n\t\treturn {\n\t\t\text: 'ktx',\n\t\t\tmime: 'image/ktx'\n\t\t};\n\t}\n\n\tif (check([0x44, 0x49, 0x43, 0x4D], {offset: 128})) {\n\t\treturn {\n\t\t\text: 'dcm',\n\t\t\tmime: 'application/dicom'\n\t\t};\n\t}\n\n\t// Musepack, SV7\n\tif (check([0x4D, 0x50, 0x2B])) {\n\t\treturn {\n\t\t\text: 'mpc',\n\t\t\tmime: 'audio/x-musepack'\n\t\t};\n\t}\n\n\t// Musepack, SV8\n\tif (check([0x4D, 0x50, 0x43, 0x4B])) {\n\t\treturn {\n\t\t\text: 'mpc',\n\t\t\tmime: 'audio/x-musepack'\n\t\t};\n\t}\n\n\tif (check([0x42, 0x45, 0x47, 0x49, 0x4E, 0x3A])) {\n\t\treturn {\n\t\t\text: 'ics',\n\t\t\tmime: 'text/calendar'\n\t\t};\n\t}\n\n\tif (check([0x67, 0x6C, 0x54, 0x46, 0x02, 0x00, 0x00, 0x00])) {\n\t\treturn {\n\t\t\text: 'glb',\n\t\t\tmime: 'model/gltf-binary'\n\t\t};\n\t}\n\n\tif (check([0xD4, 0xC3, 0xB2, 0xA1]) || check([0xA1, 0xB2, 0xC3, 0xD4])) {\n\t\treturn {\n\t\t\text: 'pcap',\n\t\t\tmime: 'application/vnd.tcpdump.pcap'\n\t\t};\n\t}\n\n\treturn null;\n};\n\nmodule.exports = fileType;\n// TODO: Remove this for the next major release\nmodule.exports.default = fileType;\n\nObject.defineProperty(fileType, 'minimumBytes', {value: 4100});\n\nmodule.exports.stream = readableStream => new Promise((resolve, reject) => {\n\t// Using `eval` to work around issues when bundling with Webpack\n\tconst stream = eval('require')('stream'); // eslint-disable-line no-eval\n\n\treadableStream.once('readable', () => {\n\t\tconst pass = new stream.PassThrough();\n\t\tconst chunk = readableStream.read(module.exports.minimumBytes) || readableStream.read();\n\t\ttry {\n\t\t\tpass.fileType = fileType(chunk);\n\t\t} catch (error) {\n\t\t\treject(error);\n\t\t}\n\n\t\treadableStream.unshift(chunk);\n\n\t\tif (stream.pipeline) {\n\t\t\tresolve(stream.pipeline(readableStream, pass, () => {}));\n\t\t} else {\n\t\t\tresolve(readableStream.pipe(pass));\n\t\t}\n\t});\n});\n","'use strict';\nconst fileType = require('file-type');\n\nconst imageExts = new Set([\n\t'jpg',\n\t'png',\n\t'gif',\n\t'webp',\n\t'flif',\n\t'cr2',\n\t'tif',\n\t'bmp',\n\t'jxr',\n\t'psd',\n\t'ico',\n\t'bpg',\n\t'jp2',\n\t'jpm',\n\t'jpx',\n\t'heic',\n\t'cur',\n\t'dcm'\n]);\n\nconst imageType = input => {\n\tconst ret = fileType(input);\n\treturn imageExts.has(ret && ret.ext) ? ret : null;\n};\n\nmodule.exports = imageType;\n// TODO: Remove this for the next major release\nmodule.exports.default = imageType;\n\nObject.defineProperty(imageType, 'minimumBytes', {value: fileType.minimumBytes});\n","module.exports = \"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\" ?>\\n<container version=\\\"1.0\\\" xmlns=\\\"urn:oasis:names:tc:opendocument:xmlns:container\\\">\\n\\t<rootfiles>\\n\\t\\t<rootfile full-path=\\\"book.opf\\\" media-type=\\\"application/oebps-package+xml\\\" />\\n\\t</rootfiles>\\n</container>\"","module.exports = \"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\" ?>\\n<!DOCTYPE html PUBLIC \\\"-//W3C//DTD XHTML 1.1//EN\\\" \\\"http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd\\\">\\n<html xmlns=\\\"http://www.w3.org/1999/xhtml\\\" xml:lang=\\\"<%= i18n.code %>\\\">\\n\\n<head>\\n\\t<title><%= i18n.cover %></title>\\n\\t<meta http-equiv=\\\"Content-Type\\\" content=\\\"application/xhtml+xml; charset=utf-8\\\" />\\n</head>\\n\\n<body>\\n\\t<div id=\\\"cover-image\\\">\\n\\t\\t<img src=\\\"../<%= cover.path %>\\\" alt=\\\"<%= i18n.cover %>\\\" />\\n\\t</div>\\n</body>\\n\\n</html>\\n\"","module.exports = \"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\" ?>\\n<!DOCTYPE html PUBLIC \\\"-//W3C//DTD XHTML 1.1//EN\\\" \\\"http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd\\\">\\n<html xmlns=\\\"http://www.w3.org/1999/xhtml\\\" xml:lang=\\\"<%= i18n.code %>\\\">\\n\\n<head>\\n\\t<title><%= i18n.note %></title>\\n\\t<meta http-equiv=\\\"Content-Type\\\" content=\\\"application/xhtml+xml; charset=utf-8\\\" />\\n</head>\\n\\n<body>\\n\\t<div id=\\\"notes-page\\\">\\n\\t\\t<div class=\\\"ugc\\\">\\n            <%- notes %>\\n\\t\\t</div>\\n\\t</div>\\n</body>\\n\\n</html>\\n\"","module.exports = \"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\" ?>\\n<!DOCTYPE html PUBLIC \\\"-//W3C//DTD XHTML 1.1//EN\\\" \\\"http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd\\\">\\n<html xmlns=\\\"http://www.w3.org/1999/xhtml\\\" xml:lang=\\\"<%= i18n.code %>\\\">\\n\\n<head>\\n\\t<title><%= title %></title>\\n\\t<meta http-equiv=\\\"Content-Type\\\" content=\\\"application/xhtml+xml; charset=utf-8\\\" />\\n</head>\\n\\n<body>\\n\\t<div class=\\\"chapter type-1\\\">\\n\\t\\t<div class=\\\"chapter-title-wrap\\\">\\n\\t\\t\\t<h2 class=\\\"chapter-title\\\"><%= title %></h2>\\n\\t\\t</div>\\n\\t\\t<div class=\\\"ugc chapter-ugc\\\">\\n            <% if (Array.isArray(content)) { %>\\n                <% content.forEach(item => { %>\\n                    <p class=\\\"indent\\\"><%= item %></p>\\n                <% }); %>\\n            <% } else { %>\\n                <%- content %>\\n            <% } %>\\n\\t\\t</div>\\n\\t</div>\\n</body>\\n\\n</html>\\n\"","module.exports = \"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\" ?>\\n<!DOCTYPE html PUBLIC \\\"-//W3C//DTD XHTML 1.1//EN\\\" \\\"http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd\\\">\\n<html xmlns=\\\"http://www.w3.org/1999/xhtml\\\" xml:lang=\\\"<%= i18n.code %>\\\">\\n\\n<head>\\n\\t<title><%= i18n.toc %></title>\\n\\t<meta http-equiv=\\\"Content-Type\\\" content=\\\"application/xhtml+xml; charset=utf-8\\\" />\\n</head>\\n\\n<body>\\n\\t<div id=\\\"toc\\\">\\n\\t\\t<h1><%= i18n.toc %></h1>\\n\\t\\t<ul>\\n            <% pages.forEach((title, index) => { %>\\n                <li class=\\\"chaptertype-1\\\">\\n                    <a href=\\\"page-<%= index %>.html\\\">\\n                        <span class=\\\"toc-chapter-title\\\"><%= title %></span>\\n                    </a>\\n                </li>\\n            <% }); %>\\n\\t\\t</ul>\\n\\t</div>\\n</body>\\n\\n</html>\\n\"","module.exports = \"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\" ?>\\n<!DOCTYPE html PUBLIC \\\"-//W3C//DTD XHTML 1.1//EN\\\" \\\"http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd\\\">\\n<html xmlns=\\\"http://www.w3.org/1999/xhtml\\\" xml:lang=\\\"<%= i18n.code %>\\\">\\n\\n<head>\\n\\t<title><%= i18n.info %></title>\\n\\t<meta http-equiv=\\\"Content-Type\\\" content=\\\"application/xhtml+xml; charset=utf-8\\\" />\\n</head>\\n\\n<body>\\n\\t<div id=\\\"title-page\\\">\\n\\t\\t<h1 class=\\\"title\\\"><%= title %></h1>\\n\\t\\t<h2 class=\\\"subtitle\\\"></h2>\\n\\t\\t<h3 class=\\\"author\\\"><%= author %></h3>\\n\\t\\t<h4 class=\\\"publisher\\\"><%= publisher %></h4>\\n\\t</div>\\n    <% if (Array.isArray(tags) && tags.length) { %>\\n        <div class=\\\"part-title-wrap\\\">\\n            <% tags = tags.join('</code>, <code>'); %>\\n            <code><%- tags %></code>\\n        </div>\\n    <% } %>\\n    <% if (description) { %>\\n        <div class=\\\"ugc\\\">\\n            <%- description %>\\n        </div>\\n    <% } %>\\n</body>\\n\\n</html>\\n\"","module.exports = \"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\" ?>\\n<package version=\\\"2.0\\\" xmlns=\\\"http://www.idpf.org/2007/opf\\\" unique-identifier=\\\"PrimaryID\\\">\\n\\n\\t<metadata xmlns:dc=\\\"http://purl.org/dc/elements/1.1/\\\" xmlns:opf=\\\"http://www.idpf.org/2007/opf\\\">\\n\\t\\t<dc:title><%= title %></dc:title>\\n\\t\\t<dc:language><%= i18n.code %></dc:language>\\n\\t\\t<dc:identifier id=\\\"PrimaryID\\\" opf:scheme=\\\"<%= uuid.scheme %>\\\"><%= uuid.id %></dc:identifier>\\n        <dc:date opf:event=\\\"publication\\\"><%= date %></dc:date>\\n        <% if (description) { %>\\n\\t\\t    <dc:description><%= description %></dc:description>\\n        <% } %>\\n\\t\\t<dc:creator opf:role=\\\"aut\\\"><%= author %></dc:creator>\\n\\t\\t<dc:publisher><%= publisher %></dc:publisher>\\n        <% if (cover) { %>\\n\\t\\t    <meta name=\\\"cover\\\" content=\\\"cover-image\\\" />\\n        <% } %>\\n        <% if (Array.isArray(tags) && tags.length) tags.forEach(tag => { %>\\n            <dc:subject><%= tag %></dc:subject>\\n        <% }); %>\\n\\t</metadata>\\n\\n\\t<manifest>\\n        <% if (cover) { %>\\n\\t\\t    <item id=\\\"front-cover\\\" href=\\\"OEBPS/front-cover.html\\\" media-type=\\\"application/xhtml+xml\\\" />\\n        <% } %>\\n\\t\\t<item id=\\\"title-page\\\" href=\\\"OEBPS/title-page.html\\\" media-type=\\\"application/xhtml+xml\\\" />\\n\\t\\t<item id=\\\"notes\\\" href=\\\"OEBPS/notes.html\\\" media-type=\\\"application/xhtml+xml\\\" />\\n\\t\\t<item id=\\\"table-of-contents\\\" href=\\\"OEBPS/table-of-contents.html\\\" media-type=\\\"application/xhtml+xml\\\" />\\n        <% pages.forEach((page, index) => { %>\\n            <item id=\\\"page-<%= index %>\\\" href=\\\"OEBPS/page-<%= index %>.html\\\" media-type=\\\"application/xhtml+xml\\\" />\\n        <% }); %>\\n        <% if (cover) { %>\\n\\t\\t    <item id=\\\"cover-image\\\" href=\\\"<%= cover.path %>\\\" media-type=\\\"<%= cover.type %>\\\" properties=\\\"cover-image\\\" />\\n        <% } %>\\n\\t\\t<item id=\\\"ncx\\\" href=\\\"toc.ncx\\\" media-type=\\\"application/x-dtbncx+xml\\\" />\\n        <% Object.keys(images).forEach(name => { %>\\n            <item id=\\\"<%= name %>\\\" href=\\\"OEBPS/<%= images[name].path %>\\\" media-type=\\\"<%= images[name].type %>\\\" />\\n        <% }); %>\\n\\t</manifest>\\n\\n\\t<spine toc=\\\"ncx\\\">\\n        <% if (cover) { %>\\n\\t\\t    <itemref idref=\\\"front-cover\\\" linear=\\\"no\\\" />\\n        <% } %>\\n\\t\\t<itemref idref=\\\"title-page\\\" linear=\\\"yes\\\" />\\n\\t\\t<itemref idref=\\\"table-of-contents\\\" linear=\\\"yes\\\" />\\n        <% pages.forEach((page, index) => { %>\\n            <itemref idref=\\\"page-<%= index %>\\\" linear=\\\"yes\\\" />\\n        <% }); %>\\n        <% if (notes) { %>\\n            <itemref idref=\\\"notes\\\" linear=\\\"yes\\\" />\\n        <% } %>\\n\\t</spine>\\n\\n\\t<guide>\\n        <% if (cover) { %>\\n\\t\\t    <reference type=\\\"cover\\\" title=\\\"<%= i18n.cover %>\\\" href=\\\"OEBPS/front-cover.html\\\" />\\n        <% } %>\\n\\t\\t<reference type=\\\"toc\\\" title=\\\"<%= i18n.toc %>\\\" href=\\\"OEBPS/table-of-contents.html\\\" />\\n\\t</guide>\\n\\n</package>\\n\"","module.exports = \"application/epub+zip\"","module.exports = \"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\" ?>\\n<!DOCTYPE ncx PUBLIC \\\"-//NISO//DTD ncx 2005-1//EN\\\" \\\"http://www.daisy.org/z3986/2005/ncx-2005-1.dtd\\\">\\n\\n<ncx version=\\\"2005-1\\\" xml:lang=\\\"<%= i18n.code %>\\\" xmlns=\\\"http://www.daisy.org/z3986/2005/ncx/\\\">\\n\\t<head>\\n\\t\\t<meta name=\\\"dtb:uid\\\" content=\\\"<%= uuid.id %>\\\" />\\n\\t\\t<meta name=\\\"dtb:depth\\\" content=\\\"2\\\" />\\n\\t\\t<meta name=\\\"dtb:totalPageCount\\\" content=\\\"0\\\" />\\n\\t\\t<meta name=\\\"dtb:maxPageNumber\\\" content=\\\"0\\\" />\\n\\t</head>\\n\\n\\t<docTitle>\\n\\t\\t<text><%= title %></text>\\n\\t</docTitle>\\n\\n\\t<docAuthor>\\n\\t\\t<text><%= author %></text>\\n\\t</docAuthor>\\n\\n\\t<navMap>\\n\\t\\t<navPoint id=\\\"title-page\\\" playOrder=\\\"1\\\">\\n\\t\\t\\t<navLabel>\\n\\t\\t\\t\\t<text><%= i18n.info %></text>\\n\\t\\t\\t</navLabel>\\n\\t\\t\\t<content src=\\\"OEBPS/title-page.html\\\" />\\n\\t\\t</navPoint>\\n\\t\\t<navPoint id=\\\"table-of-contents\\\" playOrder=\\\"2\\\">\\n\\t\\t\\t<navLabel>\\n\\t\\t\\t\\t<text><%= i18n.toc %></text>\\n\\t\\t\\t</navLabel>\\n\\t\\t\\t<content src=\\\"OEBPS/table-of-contents.html\\\" />\\n\\t\\t</navPoint>\\n        <% pages.forEach((title, index) => { %>\\n            <navPoint id=\\\"page-<%= index %>\\\" playOrder=\\\"<%= (index + 3) %>\\\">\\n                <navLabel>\\n                    <text><%= title %></text>\\n                </navLabel>\\n                <content src=\\\"OEBPS/page-<%= index %>.html\\\" />\\n            </navPoint>\\n        <% }); %>\\n        <% if (notes) { %>\\n            <navPoint id=\\\"notes-page\\\" playOrder=\\\"2\\\">\\n                <navLabel>\\n                    <text><%= i18n.note %></text>\\n                </navLabel>\\n                <content src=\\\"OEBPS/notes.html\\\" />\\n            </navPoint>\\n        <% } %>\\n\\t</navMap>\\n</ncx>\\n\"","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(\"./src/jepub.js\");\n",""],"names":["jEpub","constructor","_I18n","_Info","_Uuid","_Date","_Cover","_Pages","_Images","_Zip","init","details","JSZip","Object","assign","i18n","title","author","publisher","description","tags","scheme","id","utils","uuidv4","getISODate","language","file","mime","container","ejs","render","info","parseDOM","client","html2text","html","noBr","date","Date","uuid","isEmpty","validateUrl","cover","data","ext","Blob","type","mime2ext","ArrayBuffer","Uint8Array","path","image","name","filePath","notes","content","add","index","length","Array","isArray","template","compile","page","generate","onUpdate","support","bookConfig","pages","images","tocInBook","toc","generateAsync","mimeType","compression","compressionOptions","level","replace","c","crypto","getRandomValues","toString","isObject","obj","val","trim","toISOString","outText","doc","DOMParser","parseFromString","body","textContent","XMLSerializer","serializeToString","value","test","split"],"sourceRoot":""}